# =============================================================================
# Cardea Suricata Threshold Configuration
# =============================================================================
# This file controls alert rate limiting and suppression.
# Use this to reduce noise from frequently-triggering rules.
#
# Syntax:
#   threshold gen_id <gid>, sig_id <sid>, type <type>, track <by>, count <n>, seconds <s>
#   suppress gen_id <gid>, sig_id <sid>, track by_src, ip <ip>
#   suppress gen_id <gid>, sig_id <sid>, track by_dst, ip <ip>
#
# Types:
#   limit    - Alert on first N matches, then quiet
#   threshold - Only alert after N matches
#   both     - Alert on first match after N occurrences, then limit
# =============================================================================

# -----------------------------------------------------------------------------
# Rate Limit Noisy Rules
# -----------------------------------------------------------------------------

# ET POLICY rules - often noisy, limit to 5 per minute per source
threshold gen_id 1, sig_id 2013028, type limit, track by_src, count 5, seconds 60
threshold gen_id 1, sig_id 2013031, type limit, track by_src, count 5, seconds 60

# DNS queries - very frequent, limit to 10 per minute per source
threshold gen_id 1, sig_id 2027863, type limit, track by_src, count 10, seconds 60

# ICMP ping - limit to 3 per 10 seconds
threshold gen_id 1, sig_id 2100384, type limit, track by_src, count 3, seconds 10

# SSL certificate warnings - limit to 1 per hour per destination
threshold gen_id 1, sig_id 2025331, type limit, track by_dst, count 1, seconds 3600

# -----------------------------------------------------------------------------
# Threshold Before Alerting (Reduce False Positives)
# -----------------------------------------------------------------------------

# Port scan detection - require 25 events before alerting
threshold gen_id 1, sig_id 2010937, type threshold, track by_src, count 25, seconds 60
threshold gen_id 1, sig_id 2010935, type threshold, track by_src, count 25, seconds 60

# Brute force - require 10 attempts before alerting
threshold gen_id 1, sig_id 2019876, type threshold, track by_src, count 10, seconds 120

# -----------------------------------------------------------------------------
# Suppress Rules for Known Safe Traffic
# -----------------------------------------------------------------------------

# Example: Suppress vulnerability scanner alerts from security team's IP
# suppress gen_id 1, sig_id 0, track by_src, ip 192.168.1.100

# Example: Suppress DNS alerts for internal DNS server
# suppress gen_id 1, sig_id 2027863, track by_dst, ip 192.168.1.1

# Example: Suppress SMB alerts for file server
# suppress gen_id 1, sig_id 2025314, track by_dst, ip 192.168.1.50

# -----------------------------------------------------------------------------
# Cardea Custom Rule Thresholds (SID 9000000+)
# -----------------------------------------------------------------------------

# Internal port scan - already has threshold in rule, but add backup
threshold gen_id 1, sig_id 9000001, type both, track by_src, count 100, seconds 60

# ICMP sweep - already in rule
threshold gen_id 1, sig_id 9000002, type both, track by_src, count 30, seconds 30

# HTTP beaconing - needs many events to detect pattern
threshold gen_id 1, sig_id 9000050, type threshold, track by_src, count 120, seconds 600

# Large transfer - rate limit to avoid spam
threshold gen_id 1, sig_id 9000020, type limit, track by_src, count 3, seconds 300

# -----------------------------------------------------------------------------
# Event Filtering (completely suppress certain SIDs)
# -----------------------------------------------------------------------------

# Suppress GPL rules if using only ET rules
# suppress gen_id 1, sig_id 2100000:2199999

# Example: Completely disable specific noisy SID
# event_filter gen_id 1, sig_id 2210000, type limit, track by_src, count 0, seconds 0

# =============================================================================
# End of Threshold Configuration
# =============================================================================
